// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package confluentcloud

import (
	"context"
	"reflect"

	"github.com/pulumi/pulumi-confluentcloud/sdk/v2/go/confluentcloud/internal"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// [![General Availability](https://img.shields.io/badge/Lifecycle%20Stage-General%20Availability-%2345c6e8)](https://docs.confluent.io/cloud/current/api.html#section/Versioning/API-Lifecycle-Policy)
//
// `ProviderIntegrationAuthorization` describes the authorization configuration for a Cloud Service Provider (CSP) integration, including cloud-specific setup information like Azure multi-tenant app IDs or GCP service accounts.
//
// ## Example Usage
//
// ### Azure Provider Integration Authorization
//
// You can use the authorization data source with either approach:
//
// ### Option 1: With Azure Terraform Provider
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-azuread/sdk/go/azuread"
//	"github.com/pulumi/pulumi-confluentcloud/sdk/v2/go/confluentcloud"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			// Get the authorization data
//			azure, err := confluentcloud.LookupProviderIntegrationAuthorization(ctx, &confluentcloud.LookupProviderIntegrationAuthorizationArgs{
//				Id: "cspi-abc123",
//				Environment: confluentcloud.GetProviderIntegrationAuthorizationEnvironment{
//					Id: "env-xyz456",
//				},
//			}, nil)
//			if err != nil {
//				return err
//			}
//			// Create the service principal using Azure Terraform Provider
//			confluent, err := azuread.NewServicePrincipal(ctx, "confluent", &azuread.ServicePrincipalArgs{
//				ClientId: azure.Azures[0].ConfluentMultiTenantAppId,
//			})
//			if err != nil {
//				return err
//			}
//			ctx.Export("azureAppId", azure.Azures[0].ConfluentMultiTenantAppId)
//			ctx.Export("servicePrincipalObjectId", confluent.ObjectId)
//			return nil
//		})
//	}
//
// ```
//
// ### Option 2: With CLI Commands
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-confluentcloud/sdk/v2/go/confluentcloud"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			// Get the authorization data
//			azure, err := confluentcloud.LookupProviderIntegrationAuthorization(ctx, &confluentcloud.LookupProviderIntegrationAuthorizationArgs{
//				Id: "cspi-abc123",
//				Environment: confluentcloud.GetProviderIntegrationAuthorizationEnvironment{
//					Id: "env-xyz456",
//				},
//			}, nil)
//			if err != nil {
//				return err
//			}
//			ctx.Export("azureSetupCommand", pulumi.Sprintf("az ad sp create --id %v", azure.Azures[0].ConfluentMultiTenantAppId))
//			return nil
//		})
//	}
//
// ```
//
// ### GCP Provider Integration Authorization
//
// You can use the authorization data source with either approach:
//
// ### Option 1: With Google Terraform Provider
//
// ```go
// package main
//
// import (
//
//	"fmt"
//
//	"github.com/pulumi/pulumi-confluentcloud/sdk/v2/go/confluentcloud"
//	"github.com/pulumi/pulumi-google/sdk/go/google"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			// Get the authorization data
//			gcp, err := confluentcloud.LookupProviderIntegrationAuthorization(ctx, &confluentcloud.LookupProviderIntegrationAuthorizationArgs{
//				Id: "cspi-def456",
//				Environment: confluentcloud.GetProviderIntegrationAuthorizationEnvironment{
//					Id: "env-xyz456",
//				},
//			}, nil)
//			if err != nil {
//				return err
//			}
//			// Grant IAM permissions using Google Terraform Provider
//			_, err = google.NewProjectIamMember(ctx, "confluent_token_creator", &google.ProjectIamMemberArgs{
//				Project: gcpProjectId,
//				Role:    "roles/iam.serviceAccountTokenCreator",
//				Member:  fmt.Sprintf("serviceAccount:%v", gcp.Gcps[0].GoogleServiceAccount),
//				Condition: []map[string]interface{}{
//					map[string]interface{}{
//						"title":       "Confluent Cloud Access",
//						"description": "Allow Confluent Cloud to impersonate the customer service account",
//						"expression":  fmt.Sprintf("request.auth.claims.sub == '%v'", gcp.Gcps[0].GoogleServiceAccount),
//					},
//				},
//			})
//			if err != nil {
//				return err
//			}
//			ctx.Export("confluentServiceAccount", gcp.Gcps[0].GoogleServiceAccount)
//			ctx.Export("customerServiceAccount", gcp.Gcps[0].CustomerGoogleServiceAccount)
//			return nil
//		})
//	}
//
// ```
//
// ### Option 2: With gcloud CLI Commands
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-confluentcloud/sdk/v2/go/confluentcloud"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			// Get the authorization data
//			gcp, err := confluentcloud.LookupProviderIntegrationAuthorization(ctx, &confluentcloud.LookupProviderIntegrationAuthorizationArgs{
//				Id: "cspi-def456",
//				Environment: confluentcloud.GetProviderIntegrationAuthorizationEnvironment{
//					Id: "env-xyz456",
//				},
//			}, nil)
//			if err != nil {
//				return err
//			}
//			ctx.Export("gcpIamCommand", pulumi.Sprintf("gcloud projects add-iam-policy-binding YOUR_PROJECT_ID --member=\"serviceAccount:%v\" --role=\"roles/iam.serviceAccountTokenCreator\" --condition=\"expression=request.auth.claims.sub=='%v'\"", gcp.Gcps[0].GoogleServiceAccount, gcp.Gcps[0].GoogleServiceAccount))
//			ctx.Export("confluentServiceAccount", gcp.Gcps[0].GoogleServiceAccount)
//			return nil
//		})
//	}
//
// ```
//
// ### Using with Integration Data Source
//
// ```go
// package main
//
// import (
//
//	"fmt"
//
//	"github.com/pulumi/pulumi-confluentcloud/sdk/v2/go/confluentcloud"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			main, err := confluentcloud.LookupProviderIntegrationSetup(ctx, &confluentcloud.LookupProviderIntegrationSetupArgs{
//				DisplayName: pulumi.StringRef("my-integration"),
//				Environment: confluentcloud.GetProviderIntegrationSetupEnvironment{
//					Id: "env-xyz456",
//				},
//			}, nil)
//			if err != nil {
//				return err
//			}
//			mainGetProviderIntegrationAuthorization, err := confluentcloud.LookupProviderIntegrationAuthorization(ctx, &confluentcloud.LookupProviderIntegrationAuthorizationArgs{
//				Id: main.Id,
//				Environment: confluentcloud.GetProviderIntegrationAuthorizationEnvironment{
//					Id: "env-xyz456",
//				},
//			}, nil)
//			if err != nil {
//				return err
//			}
//			var tmp0 map[string]interface{}
//			if main.Cloud == "AZURE" {
//				tmp0 = map[string]interface{}{
//					"appId":   mainGetProviderIntegrationAuthorization.Azures[0].ConfluentMultiTenantAppId,
//					"command": fmt.Sprintf("az ad sp create --id %v", mainGetProviderIntegrationAuthorization.Azures[0].ConfluentMultiTenantAppId),
//				}
//			} else {
//				tmp0 = map[string]interface{}{
//					"confluentSa": mainGetProviderIntegrationAuthorization.Gcps[0].GoogleServiceAccount,
//					"customerSa":  mainGetProviderIntegrationAuthorization.Gcps[0].CustomerGoogleServiceAccount,
//				}
//			}
//			ctx.Export("setupInfo", tmp0)
//			return nil
//		})
//	}
//
// ```
//
// ## Getting Started
//
// The following end-to-end examples might help to get started with `ProviderIntegrationAuthorization` data source:
// * provider-integration-azure: Complete Azure Provider Integration setup
// * provider-integration-gcp: Complete GCP Provider Integration setup
func LookupProviderIntegrationAuthorization(ctx *pulumi.Context, args *LookupProviderIntegrationAuthorizationArgs, opts ...pulumi.InvokeOption) (*LookupProviderIntegrationAuthorizationResult, error) {
	opts = internal.PkgInvokeDefaultOpts(opts)
	var rv LookupProviderIntegrationAuthorizationResult
	err := ctx.Invoke("confluentcloud:index/getProviderIntegrationAuthorization:getProviderIntegrationAuthorization", args, &rv, opts...)
	if err != nil {
		return nil, err
	}
	return &rv, nil
}

// A collection of arguments for invoking getProviderIntegrationAuthorization.
type LookupProviderIntegrationAuthorizationArgs struct {
	// (Required Configuration Block) supports the following:
	Environment GetProviderIntegrationAuthorizationEnvironment `pulumi:"environment"`
	// The ID of the Provider Integration Authorization, for example, `cspi-4xg0q`.
	Id string `pulumi:"id"`
}

// A collection of values returned by getProviderIntegrationAuthorization.
type LookupProviderIntegrationAuthorizationResult struct {
	// (Optional Configuration Block) Azure-specific configuration details. Present for Azure integrations. It supports the following:
	Azures []GetProviderIntegrationAuthorizationAzure `pulumi:"azures"`
	// (Required Configuration Block) supports the following:
	Environment GetProviderIntegrationAuthorizationEnvironment `pulumi:"environment"`
	// (Optional Configuration Block) GCP-specific configuration details. Present for GCP integrations. It supports the following:
	Gcps []GetProviderIntegrationAuthorizationGcp `pulumi:"gcps"`
	// (Required String) The ID of the Environment that the Provider Integration belongs to, for example, `env-abc123`.
	Id string `pulumi:"id"`
	// (Required String) The ID of the provider integration.
	ProviderIntegrationId string `pulumi:"providerIntegrationId"`
}

func LookupProviderIntegrationAuthorizationOutput(ctx *pulumi.Context, args LookupProviderIntegrationAuthorizationOutputArgs, opts ...pulumi.InvokeOption) LookupProviderIntegrationAuthorizationResultOutput {
	return pulumi.ToOutputWithContext(ctx.Context(), args).
		ApplyT(func(v interface{}) (LookupProviderIntegrationAuthorizationResultOutput, error) {
			args := v.(LookupProviderIntegrationAuthorizationArgs)
			options := pulumi.InvokeOutputOptions{InvokeOptions: internal.PkgInvokeDefaultOpts(opts)}
			return ctx.InvokeOutput("confluentcloud:index/getProviderIntegrationAuthorization:getProviderIntegrationAuthorization", args, LookupProviderIntegrationAuthorizationResultOutput{}, options).(LookupProviderIntegrationAuthorizationResultOutput), nil
		}).(LookupProviderIntegrationAuthorizationResultOutput)
}

// A collection of arguments for invoking getProviderIntegrationAuthorization.
type LookupProviderIntegrationAuthorizationOutputArgs struct {
	// (Required Configuration Block) supports the following:
	Environment GetProviderIntegrationAuthorizationEnvironmentInput `pulumi:"environment"`
	// The ID of the Provider Integration Authorization, for example, `cspi-4xg0q`.
	Id pulumi.StringInput `pulumi:"id"`
}

func (LookupProviderIntegrationAuthorizationOutputArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*LookupProviderIntegrationAuthorizationArgs)(nil)).Elem()
}

// A collection of values returned by getProviderIntegrationAuthorization.
type LookupProviderIntegrationAuthorizationResultOutput struct{ *pulumi.OutputState }

func (LookupProviderIntegrationAuthorizationResultOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*LookupProviderIntegrationAuthorizationResult)(nil)).Elem()
}

func (o LookupProviderIntegrationAuthorizationResultOutput) ToLookupProviderIntegrationAuthorizationResultOutput() LookupProviderIntegrationAuthorizationResultOutput {
	return o
}

func (o LookupProviderIntegrationAuthorizationResultOutput) ToLookupProviderIntegrationAuthorizationResultOutputWithContext(ctx context.Context) LookupProviderIntegrationAuthorizationResultOutput {
	return o
}

// (Optional Configuration Block) Azure-specific configuration details. Present for Azure integrations. It supports the following:
func (o LookupProviderIntegrationAuthorizationResultOutput) Azures() GetProviderIntegrationAuthorizationAzureArrayOutput {
	return o.ApplyT(func(v LookupProviderIntegrationAuthorizationResult) []GetProviderIntegrationAuthorizationAzure {
		return v.Azures
	}).(GetProviderIntegrationAuthorizationAzureArrayOutput)
}

// (Required Configuration Block) supports the following:
func (o LookupProviderIntegrationAuthorizationResultOutput) Environment() GetProviderIntegrationAuthorizationEnvironmentOutput {
	return o.ApplyT(func(v LookupProviderIntegrationAuthorizationResult) GetProviderIntegrationAuthorizationEnvironment {
		return v.Environment
	}).(GetProviderIntegrationAuthorizationEnvironmentOutput)
}

// (Optional Configuration Block) GCP-specific configuration details. Present for GCP integrations. It supports the following:
func (o LookupProviderIntegrationAuthorizationResultOutput) Gcps() GetProviderIntegrationAuthorizationGcpArrayOutput {
	return o.ApplyT(func(v LookupProviderIntegrationAuthorizationResult) []GetProviderIntegrationAuthorizationGcp {
		return v.Gcps
	}).(GetProviderIntegrationAuthorizationGcpArrayOutput)
}

// (Required String) The ID of the Environment that the Provider Integration belongs to, for example, `env-abc123`.
func (o LookupProviderIntegrationAuthorizationResultOutput) Id() pulumi.StringOutput {
	return o.ApplyT(func(v LookupProviderIntegrationAuthorizationResult) string { return v.Id }).(pulumi.StringOutput)
}

// (Required String) The ID of the provider integration.
func (o LookupProviderIntegrationAuthorizationResultOutput) ProviderIntegrationId() pulumi.StringOutput {
	return o.ApplyT(func(v LookupProviderIntegrationAuthorizationResult) string { return v.ProviderIntegrationId }).(pulumi.StringOutput)
}

func init() {
	pulumi.RegisterOutputType(LookupProviderIntegrationAuthorizationResultOutput{})
}
